function [wgs84_lat_out_rad,wgs84_lon_out_rad,wgs84_alt_out_m] = ...
    convertECEF_ToGeodeticWGS84LatLonAlt (x_m, y_m,z_m)
    
    WGS84_SEMI_MAJOR = 6378137.0;
    WGS84_SEMI_MAJOR2 = WGS84_SEMI_MAJOR * WGS84_SEMI_MAJOR;
    WGS84_RECIPROCAL_OF_FLATTENING = 298.257223563;
    WGS84_GRAVITATIONAL_CONSTANT = 3986004.418e8;
    WGS84_ANGULAR_VELOCITY = 7292115e-11;
    WGS84_SEMI_MINOR = 6356752.3142;
    WGS84_FIRST_ECCENTRICITY = 8.1819190842622e-2;
    WGS84_FIRST_ECCENTRICITY_SQUARED = 6.69437999014e-3;
    WGS84_SECOND_ECCENTRICITY = 8.2094437949696e-2;
    WGS84_SECOND_ECCENTRICITY_SQUARED = 6.73949674228e-3;
    WGS84_LINEAR_ECCENTRICITY = 5.2185400842339e5;
    WGS84_POLAR_RADIUS_OF_CURVATURE = 6399593.6258;
    WGS84_AXIS_RATIO = 0.996647189335;
    WGS84_MEAN_RADIUS_OF_SEMI_AXES = 6371008.7714;
    WGS84_RADIUS_OF_SPHERE_OF_EQUAL_AREA = 6371007.1809;
    WGS84_RADIUS_OF_SPHERE_OF_EQUAL_VOLUME = 6371000.7900;
    WGS84_SEMI_MINOR2 = WGS84_SEMI_MINOR * WGS84_SEMI_MINOR;
    

         z_m2 = z_m * z_m ;

         r = sqrt ( x_m * x_m + y_m * y_m ) ;
         r2 = r * r ;
         E2 = WGS84_SEMI_MAJOR2 - WGS84_SEMI_MINOR2 ;
         F = 54.0 * WGS84_SEMI_MINOR2 * z_m2 ;
         G = r2 + ( 1.0-WGS84_FIRST_ECCENTRICITY_SQUARED ) *z_m2 - WGS84_FIRST_ECCENTRICITY_SQUARED * E2 ;
         C = WGS84_FIRST_ECCENTRICITY_SQUARED * WGS84_FIRST_ECCENTRICITY_SQUARED * F * r2 / ( G*G*G ) ;
         S = ( ( 1.0+C + sqrt ( C*C + 2.0*C ) )).^(1.0/3.0 ) ;
         P = F / ( 3.0*( S+1.0/S+1.0).^2 *G*G ) ;
         Q = sqrt ( 1.0 + 2.0*WGS84_FIRST_ECCENTRICITY_SQUARED * WGS84_FIRST_ECCENTRICITY_SQUARED * P ) ;
         r0 = -( P*WGS84_FIRST_ECCENTRICITY_SQUARED*r ) / ( 1.0+Q ) + sqrt ( 0.5 * WGS84_SEMI_MAJOR2 * ( 1.0+1.0/Q ) - P* ( 1.0-WGS84_FIRST_ECCENTRICITY_SQUARED ) *z_m2 / ( Q* ( 1.0+Q ) ) - 0.5 * P * r2 ) ;
         U = sqrt (  ( r-WGS84_FIRST_ECCENTRICITY_SQUARED*r0).^2 +z_m2 ) ;
         V = sqrt (  ( r-WGS84_FIRST_ECCENTRICITY_SQUARED*r0).^2 + ( 1.0-WGS84_FIRST_ECCENTRICITY_SQUARED ) *z_m2 ) ;
         Z0 = ( WGS84_SEMI_MINOR2 * z_m ) / ( WGS84_SEMI_MAJOR * V ) ;

        wgs84_alt_out_m = U * ( 1.0 - WGS84_SEMI_MINOR2 / ( WGS84_SEMI_MAJOR * V ) );
        wgs84_lat_out_rad = atan ( ( z_m+WGS84_SECOND_ECCENTRICITY_SQUARED*Z0 ) / ( r ) );
        wgs84_lon_out_rad = atan2 ( y_m,x_m );
    